# 用于虹膜跟踪的机器学习管道
该机器学习管道的第一步依赖于3D面部网格检测算法，这个算法应用了高保证面部landmarks来生成面部结构的大致网格。从这些网格中，我们可以从原始图像中分离出眼部图像，将该图像应用于虹膜跟踪模型。然后问题就被分为两个部分：眼部轮廓估计与虹膜定位。设计一个多任务模型，该模型对每一个任务具有统一的编码器，各任务具有单独组件，该设计允许我们使用特定任务的训练数据。
为了使用裁剪后的眼部区域图像训练该模型，我们手动标注了大约50k张图像，涵盖了各类光照条件与头部姿态的各个国家与地区的人眼图像。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/22656197/1642668384360-8a6fe769-40fa-4e5d-9aff-24b745b1b730.png)
_人眼区域标注，使用红色标注眼皮，蓝色标注虹膜轮廓_


![image.png](https://cdn.nlark.com/yuque/0/2022/png/22656197/1642668738446-fe062743-fb5e-460c-ba8c-fa5f55f07f24.png)
_模型的输入是裁剪后的人眼区域图像，预测结果中通过单独的任务解码器产生人眼landmarks，通过单独任务解码器产生虹膜lanmarks_
​

# **Depth-from-Iris：基于单张图像的虹膜深度估计**
虹膜跟踪模型能够确定人眼与相机的距离，再不需要任何其他额外设备的情况下做到误差不超过10%。这依赖于人类横向虹膜尺寸的一致性，有研究表明，人眼尺寸持续保持在11.7±0.5毫米并且拥有简单的几何结构。如插图所示，针孔摄像机将图像映射到方形区域的传感器上成像。人眼landmarks到摄像头的距离可以通过摄像机的焦距长度估算，摄像机的焦距可以通过图像中的EXIF元信息获得，摄像机的其他参数为固有参数，给定焦距长度，可以直接通过人眼实际尺寸与成像人眼的像素尺寸求得人眼与摄像机的距离。
![image.png](https://cdn.nlark.com/yuque/0/2022/png/22656197/1642670302555-4ba91b40-b841-4312-b0cd-43a647eea45e.png)
_人眼与摄像机的距离（d）可以通过相机焦距（f）人眼固定尺寸以及成像尺寸，结合相似三角形定律求得_
​





参考文献：
[MediaPipe Iris: Real-time Iris Tracking & Depth Estimation](https://ai.googleblog.com/2020/08/mediapipe-iris-real-time-iris-tracking.html)
